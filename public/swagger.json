{
  "openapi": "3.0.0",
  "info": {
    "title": "Lunme API",
    "version": "1.0.0",
    "description": "Swagger gerado automaticamente pelas rotas do Next.js"
  },
  "servers": [
    {
      "url": "http://localhost:3000"
    }
  ],
  "paths": {
    "/api/amnp/{token}": {
      "get": {
        "summary": "Valida o acesso temporário à anamnese por token",
        "description": "Valida um token temporário de acesso à anamnese.   O link expira em 10 minutos e só pode ser acessado pelo mesmo IP após o primeiro acesso.\n",
        "tags": [
          "Anamnese"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "token",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Token único de acesso enviado ao paciente."
          }
        ],
        "responses": {
          "200": {
            "description": "Acesso autorizado.",
            "content": {
              "application/json": {
                "examples": {
                  "permitido": {
                    "summary": "Token válido",
                    "value": {
                      "autorizado": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Token não informado.",
            "content": {
              "application/json": {
                "example": {
                  "autorizado": false,
                  "erro": "Token ausente"
                }
              }
            }
          },
          "403": {
            "description": "Token expirado ou inválido após validações.",
            "content": {
              "application/json": {
                "oneOf": [
                  {
                    "example": {
                      "autorizado": false,
                      "erro": "Link expirado (tempo excedido)"
                    }
                  },
                  {
                    "example": {
                      "autorizado": false,
                      "erro": "Link expirado ou IP diferente"
                    }
                  }
                ]
              }
            }
          },
          "404": {
            "description": "Token inexistente no banco.",
            "content": {
              "application/json": {
                "example": {
                  "autorizado": false,
                  "erro": "Token inválido"
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor."
          }
        }
      },
      "delete": {
        "summary": "Remove um registro de acesso temporário à anamnese",
        "description": "Deleta manualmente um token temporário de acesso à anamnese.   Usado para revogação imediata do link.\n",
        "tags": [
          "Anamnese"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "token",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Token temporário que será removido."
          }
        ],
        "responses": {
          "200": {
            "description": "Registro removido com sucesso.",
            "content": {
              "application/json": {
                "example": {
                  "sucesso": true,
                  "mensagem": "Registro removido com sucesso"
                }
              }
            }
          },
          "400": {
            "description": "Falta o token na URL.",
            "content": {
              "application/json": {
                "example": {
                  "erro": "Token ausente"
                }
              }
            }
          },
          "404": {
            "description": "Nenhum registro corresponde ao token informado.",
            "content": {
              "application/json": {
                "example": {
                  "erro": "Registro não encontrado"
                }
              }
            }
          },
          "500": {
            "description": "Erro inesperado ao tentar remover o registro.",
            "content": {
              "application/json": {
                "example": {
                  "erro": "Erro interno ao tentar deletar"
                }
              }
            }
          }
        }
      }
    },
    "/api/analize_pcte": {
      "post": {
        "summary": "Cria um pré-cadastro de paciente com os dados da anamnese inicial, marcando-o como não habilitado.",
        "description": "Recebe todas as informações iniciais fornecidas pelo paciente e cria um registro de pré-anamnese vinculado a um psicólogo responsável.\n",
        "tags": [
          "Anamnese"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "nome",
                  "email",
                  "idade",
                  "cpf",
                  "preocupacao",
                  "motivoAtendimento",
                  "psicologoId"
                ],
                "properties": {
                  "nome": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "idade": {
                    "type": "integer"
                  },
                  "cpf": {
                    "type": "string"
                  },
                  "telefone": {
                    "type": "string"
                  },
                  "origemConhecimento": {
                    "type": "string"
                  },
                  "preocupacao": {
                    "type": "string"
                  },
                  "motivoAtendimento": {
                    "type": "string"
                  },
                  "experienciaAnterior": {
                    "type": "string"
                  },
                  "saudeFisica": {
                    "type": "string"
                  },
                  "detalhesSaudeFisica": {
                    "type": "string"
                  },
                  "medicamentos": {
                    "type": "string"
                  },
                  "diagnosticoMental": {
                    "type": "string"
                  },
                  "historicoFamiliar": {
                    "type": "string"
                  },
                  "rotina": {
                    "type": "string"
                  },
                  "sono": {
                    "type": "string"
                  },
                  "atividadeFisica": {
                    "type": "string"
                  },
                  "estresse": {
                    "type": "string"
                  },
                  "convivencia": {
                    "type": "string"
                  },
                  "relacaoFamiliar": {
                    "type": "string"
                  },
                  "apoioSocial": {
                    "type": "string"
                  },
                  "nivelFelicidade": {
                    "type": "string"
                  },
                  "ansiedade": {
                    "type": "string"
                  },
                  "pensamentosNegativos": {
                    "type": "string"
                  },
                  "objetivoTerapia": {
                    "type": "string"
                  },
                  "temasDelicados": {
                    "type": "string"
                  },
                  "estiloAtendimento": {
                    "type": "string"
                  },
                  "observacoesFinais": {
                    "type": "string"
                  },
                  "autorizacaoLGPD": {
                    "type": "boolean"
                  },
                  "psicologoId": {
                    "type": "string"
                  }
                }
              },
              "example": {
                "nome": "João da Silva",
                "email": "joao@email.com",
                "idade": 28,
                "cpf": "12345678900",
                "telefone": "27999999999",
                "origemConhecimento": "Instagram",
                "preocupacao": "Ansiedade e estresse",
                "motivoAtendimento": "Quero ajuda profissional",
                "experienciaAnterior": "Nenhuma",
                "saudeFisica": "Boa",
                "detalhesSaudeFisica": "",
                "medicamentos": "",
                "diagnosticoMental": "",
                "historicoFamiliar": "",
                "rotina": "Trabalho e estudo",
                "sono": "Irregular",
                "atividadeFisica": "Raramente",
                "estresse": "Alto",
                "convivencia": "Boa",
                "relacaoFamiliar": "Boa",
                "apoioSocial": "Moderado",
                "nivelFelicidade": "Médio",
                "ansiedade": "Alta",
                "pensamentosNegativos": "Ocasional",
                "objetivoTerapia": "Melhorar saúde emocional",
                "temasDelicados": "Nenhum",
                "estiloAtendimento": "Empático",
                "observacoesFinais": "",
                "autorizacaoLGPD": true,
                "psicologoId": "uuid-do-psicologo"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Pré-cadastro criado com sucesso.",
            "content": {
              "application/json": {
                "example": {
                  "message": "Pré-cadastro de anamnese realizado com sucesso!",
                  "data": {
                    "id": "uuid-gerado",
                    "nome": "João da Silva",
                    "cpf": "12345678900",
                    "habilitado": false
                  }
                }
              }
            }
          },
          "400": {
            "description": "Campos obrigatórios ausentes.",
            "content": {
              "application/json": {
                "example": {
                  "error": "Todos os campos são obrigatórios!"
                }
              }
            }
          },
          "409": {
            "description": "CPF já está cadastrado.",
            "content": {
              "application/json": {
                "example": {
                  "error": "CPF já cadastrado!"
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor.",
            "content": {
              "application/json": {
                "example": {
                  "error": "Erro interno do servidor."
                }
              }
            }
          }
        }
      }
    },
    "/api/analize_psco": {
      "post": {
        "summary": "Realiza o pré-cadastro de um psicólogo",
        "description": "Registra um psicólogo em estado preliminar (não habilitado) no sistema, armazenando todos os dados pessoais e profissionais necessários para análise interna.\n",
        "tags": [
          "Psicólogos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "cpf",
                  "crp",
                  "nome",
                  "lastname",
                  "rg",
                  "email",
                  "data_nasc",
                  "celular",
                  "telefone"
                ],
                "properties": {
                  "cpf": {
                    "type": "string"
                  },
                  "cfp": {
                    "type": "string",
                    "description": "Campo opcional adicional"
                  },
                  "crp": {
                    "type": "string"
                  },
                  "nome": {
                    "type": "string"
                  },
                  "lastname": {
                    "type": "string"
                  },
                  "rg": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "data_nasc": {
                    "type": "string",
                    "format": "date"
                  },
                  "celular": {
                    "type": "string"
                  },
                  "telefone": {
                    "type": "string"
                  }
                }
              },
              "example": {
                "cpf": "12345678900",
                "cfp": "00011122233",
                "crp": "08/123456",
                "nome": "Maria",
                "lastname": "Souza",
                "rg": "12345678",
                "email": "maria@example.com",
                "data_nasc": "1990-05-12",
                "celular": "27999999999",
                "telefone": "2733333333"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Pré-cadastro realizado com sucesso.",
            "content": {
              "application/json": {
                "example": {
                  "message": "Pré-cadastro realizado com sucesso!",
                  "data": {
                    "id": "uuid-gerado",
                    "cpf": "12345678900",
                    "crp": "08/123456",
                    "habilitado": false
                  }
                }
              }
            }
          },
          "400": {
            "description": "Campos obrigatórios ausentes.",
            "content": {
              "application/json": {
                "example": {
                  "error": "Todos os campos são obrigatórios!"
                }
              }
            }
          },
          "409": {
            "description": "Conflito — CPF ou CFP já cadastrados.",
            "content": {
              "application/json": {
                "example": {
                  "error": "CPF ou CFP já cadastrado!"
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor.",
            "content": {
              "application/json": {
                "example": {
                  "error": "Erro interno do servidor!"
                }
              }
            }
          }
        }
      }
    },
    "/api/avaliacao": {
      "post": {
        "summary": "Registra uma nova avaliação sobre a reuniãoo e o atendimento",
        "description": "Permite que um paciente registre uma avaliação contendo notas sobre áudio, vídeo, experiência geral, avaliação profissional e um comentário opcional.\n",
        "tags": [
          "Avaliações"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "audio",
                  "video",
                  "experienciaGeral",
                  "avaliacaoProfissional",
                  "psicologoId"
                ],
                "properties": {
                  "audio": {
                    "type": "number",
                    "description": "Nota de 1 a 5 referente à qualidade do áudio."
                  },
                  "video": {
                    "type": "number",
                    "description": "Nota de 1 a 5 referente à qualidade do vídeo."
                  },
                  "experienciaGeral": {
                    "type": "number",
                    "description": "Nota geral da experiência."
                  },
                  "avaliacaoProfissional": {
                    "type": "number",
                    "description": "Nota referente ao atendimento profissional."
                  },
                  "comentario": {
                    "type": "string",
                    "description": "Comentários adicionais (opcional)."
                  },
                  "psicologoId": {
                    "type": "string",
                    "description": "ID do psicólogo avaliado."
                  }
                }
              },
              "example": {
                "audio": 5,
                "video": 4,
                "experienciaGeral": 5,
                "avaliacaoProfissional": 5,
                "comentario": "Atendimento excelente, muito acolhedor!",
                "psicologoId": "clt9xpq1f0001x9z9a1cdefg"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Avaliação registrada com sucesso.",
            "content": {
              "application/json": {
                "example": {
                  "id": "clt9z03uc0000x9zg9dgd1234",
                  "audio": 5,
                  "video": 4,
                  "experienciaGeral": 5,
                  "avaliacaoProfissional": 5,
                  "comentario": "Atendimento excelente, muito acolhedor!",
                  "psicologoId": "clt9xpq1f0001x9z9a1cdefg",
                  "createdAt": "2025-01-01T12:00:00.000Z"
                }
              }
            }
          },
          "400": {
            "description": "Dados enviados inválidos.",
            "content": {
              "application/json": {
                "example": {
                  "error": "Campos obrigatórios inválidos."
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao criar a avaliação.",
            "content": {
              "application/json": {
                "example": {
                  "error": "Erro interno ao criar avaliação."
                }
              }
            }
          }
        }
      }
    },
    "/api/consent": {
      "post": {
        "summary": "Registra o consentimento lgpd do usuario.",
        "description": "Salva no banco de dados a confirmação do termo de consentimento, incluindo IP, data, hora, nome e CPF.",
        "tags": [
          "Consentimento"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "data",
                  "hora",
                  "ip",
                  "nome",
                  "cpf"
                ],
                "properties": {
                  "data": {
                    "type": "string",
                    "example": "2025-11-17"
                  },
                  "hora": {
                    "type": "string",
                    "example": "23:55:12"
                  },
                  "ip": {
                    "type": "string",
                    "example": "192.168.0.10"
                  },
                  "nome": {
                    "type": "string",
                    "example": "Jhon Doe"
                  },
                  "cpf": {
                    "type": "string",
                    "example": "123.456.789-00"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Consentimento registrado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "example": "clxyz0987"
                    },
                    "ipNumber": {
                      "type": "string"
                    },
                    "data_consent": {
                      "type": "string"
                    },
                    "hora_consent": {
                      "type": "string"
                    },
                    "nome_consent": {
                      "type": "string"
                    },
                    "cpf_consent": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao salvar consentimento.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao salvar consentimento"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/cookies-consent": {
      "get": {
        "summary": "Verifica se o usuário já deu consentimento para cookies.",
        "description": "Retorna o registro de consentimento baseado no IP do cliente. Se estiver expirado (mais de 30 dias), o registro é removido e retornado 404.",
        "tags": [
          "uso de cookies"
        ],
        "parameters": [
          {
            "in": "header",
            "name": "x-forwarded-for",
            "required": false,
            "description": "IP real do usuário (usado quando a aplicação está atrás de proxy).",
            "schema": {
              "type": "string",
              "example": "201.22.31.45"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Consentimento encontrado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "example": "clxyzc12345"
                    },
                    "ipNumber": {
                      "type": "string",
                      "example": "201.22.31.45"
                    },
                    "data": {
                      "type": "string",
                      "example": "17/11/2025"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Consentimento não encontrado ou expirado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Consentimento não encontrado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro ao buscar consentimento.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao buscar consentimento"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Registra o consentimento de cookies do usuário.",
        "description": "Armazena no banco o consentimento baseado no IP do cliente, junto com data, hora e status (aceito ou não).",
        "tags": [
          "uso de cookies"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "accepted",
                  "timestamp"
                ],
                "properties": {
                  "accepted": {
                    "type": "boolean",
                    "example": true,
                    "description": "Indica se o usuário aceitou os cookies."
                  },
                  "timestamp": {
                    "type": "string",
                    "format": "date-time",
                    "example": "2025-11-17T23:59:00.000Z",
                    "description": "Momento exato do consentimento."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Consentimento salvo com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Corpo da requisição inválido."
          },
          "500": {
            "description": "Erro interno ao salvar consentimento."
          }
        }
      }
    },
    "/api/internal/analize_psco": {
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Lista todos os pré-psicólogos cadastrados",
        "description": "Retorna todos os registros de pré-psicólogos armazenados no sistema.",
        "tags": [
          "Interno - Psicólogos"
        ],
        "responses": {
          "200": {
            "description": "Lista retornada com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "description": "Dados de cada pré-psicólogo."
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno do servidor!"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Realiza o pré-cadastro de um psicólogo",
        "description": "Registra um novo pré-psicólogo no sistema. Todos os campos são obrigatórios. esse endpoint sera removido futuramente",
        "tags": [
          "Interno - Analise de Psicólogos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "cpf",
                  "crp",
                  "nome",
                  "lastname",
                  "rg",
                  "email",
                  "data_nasc",
                  "celular",
                  "telefone"
                ],
                "properties": {
                  "cpf": {
                    "type": "string"
                  },
                  "cfp": {
                    "type": "string"
                  },
                  "crp": {
                    "type": "string"
                  },
                  "nome": {
                    "type": "string"
                  },
                  "lastname": {
                    "type": "string"
                  },
                  "rg": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "data_nasc": {
                    "type": "string",
                    "format": "date"
                  },
                  "celular": {
                    "type": "string"
                  },
                  "telefone": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Pré-cadastro realizado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Pré-cadastro realizado com sucesso!"
                    },
                    "data": {
                      "type": "object",
                      "description": "Dados do psicólogo criado."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Campos obrigatórios ausentes.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Todos os campos são obrigatórios!"
                    }
                  }
                }
              }
            }
          },
          "409": {
            "description": "CPF ou CRP já cadastrados.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "CPF ou CFP já cadastrado!"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno do servidor!"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Habilita um psicólogo previamente pré-cadastrado",
        "description": "Ativa um pré-psicólogo no sistema, atualiza o status de habilitado e dispara o fluxo de efetivação.",
        "tags": [
          "Interno - Analise de Psicólogos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "cpf"
                ],
                "properties": {
                  "cpf": {
                    "type": "string",
                    "example": "12345678900"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Psicólogo habilitado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Psicólogo habilitado com sucesso"
                    },
                    "data": {
                      "type": "object",
                      "description": "Dados completos do psicólogo após habilitação."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "CPF ausente ou sobrenome não definido.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "examples": {
                        "cpf_ausente": {
                          "value": "CPF é obrigatório"
                        },
                        "lastname_ausente": {
                          "value": "Sobrenome do psicólogo é obrigatório"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Psicólogo não encontrado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Psicólogo não encontrado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno do servidor!"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Remove um pré-psicólogo do sistema",
        "description": "Exclui o registro de um pré-psicólogo com base no CPF.  \nSe o psicólogo não estiver habilitado, envia notificação antes da exclusão.\n",
        "tags": [
          "Interno - Analise de Psicólogos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "cpf"
                ],
                "properties": {
                  "cpf": {
                    "type": "string",
                    "example": "12345678900"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Psicólogo removido com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Psicólogo removido com sucesso"
                    },
                    "deletedCpf": {
                      "type": "string",
                      "example": "12345678900"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "CPF não informado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "CPF é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Psicólogo não encontrado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Psicólogo não encontrado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno do servidor"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/creditos": {
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Consulta os créditos de um usuário",
        "description": "Retorna a quantidade de créditos disponíveis de um usuário específico no sistema.",
        "tags": [
          "Interno - Creditos"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do usuário que se deseja consultar os créditos."
          }
        ],
        "responses": {
          "200": {
            "description": "Créditos retornados com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "creditos": {
                      "type": "number",
                      "example": 120
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "userId não informado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "userId é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Usuário não encontrado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Usuário não encontrado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao buscar créditos.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno ao buscar créditos"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/gen-meet": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Cria uma nova consulta",
        "description": "Registra uma nova consulta associada a paciente e psicólogo.",
        "tags": [
          "Interno - Agendamentos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "pacienteId",
                  "name",
                  "fantasy_name",
                  "psicologoId",
                  "data",
                  "hora",
                  "tipo_consulta",
                  "duracao"
                ],
                "properties": {
                  "pacienteId": {
                    "type": "string",
                    "example": "user_12345"
                  },
                  "name": {
                    "type": "string",
                    "example": "João Silva"
                  },
                  "fantasy_name": {
                    "type": "string",
                    "example": "Clínica Exemplo"
                  },
                  "psicologoId": {
                    "type": "string",
                    "example": "psico_98765"
                  },
                  "data": {
                    "type": "string",
                    "format": "date",
                    "example": "2025-11-20"
                  },
                  "hora": {
                    "type": "string",
                    "example": "14:30"
                  },
                  "tipo_consulta": {
                    "type": "string",
                    "example": "Online"
                  },
                  "observacao": {
                    "type": "string",
                    "example": "Consulta de avaliação inicial"
                  },
                  "recorrencia": {
                    "type": "string",
                    "example": "Semanal"
                  },
                  "duracao": {
                    "type": "number",
                    "example": 50
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Consulta criada com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "example": "consulta_123456"
                    },
                    "pacienteId": {
                      "type": "string"
                    },
                    "name": {
                      "type": "string"
                    },
                    "fantasy_name": {
                      "type": "string"
                    },
                    "titulo": {
                      "type": "string",
                      "example": "Consulta"
                    },
                    "psicologoId": {
                      "type": "string"
                    },
                    "data": {
                      "type": "string"
                    },
                    "hora": {
                      "type": "string"
                    },
                    "tipo_consulta": {
                      "type": "string"
                    },
                    "observacao": {
                      "type": "string"
                    },
                    "recorrencia": {
                      "type": "string"
                    },
                    "code": {
                      "type": "string"
                    },
                    "duracao": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro ao criar consulta.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao criar reunião"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Lista todas as consultas de um psicólogo",
        "description": "Retorna todas as consultas associadas a um psicólogo específico.  \nCaso não existam consultas, retorna um exemplo de consulta fictícia para exibição.\n",
        "tags": [
          "Interno - Agendamentos"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do psicólogo cujas consultas serão listadas."
          }
        ],
        "responses": {
          "200": {
            "description": "Consultas retornadas com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string",
                        "example": "consulta_12345"
                      },
                      "pacienteId": {
                        "type": "string",
                        "nullable": true
                      },
                      "fantasy_name": {
                        "type": "string",
                        "example": "Este agendamento é apenas um exemplo"
                      },
                      "name": {
                        "type": "string",
                        "example": "Consulta Demonstrativa"
                      },
                      "titulo": {
                        "type": "string",
                        "example": "Sessão de Demonstração"
                      },
                      "psicologoId": {
                        "type": "string"
                      },
                      "data": {
                        "type": "string",
                        "format": "date",
                        "example": "2025-11-20"
                      },
                      "hora": {
                        "type": "string",
                        "example": "10:00"
                      },
                      "tipo_consulta": {
                        "type": "string",
                        "example": "online"
                      },
                      "observacao": {
                        "type": "string",
                        "example": "Esta é uma consulta fictícia para fins de exibição."
                      },
                      "recorrencia": {
                        "type": "string",
                        "nullable": true
                      },
                      "code": {
                        "type": "string",
                        "example": "fake-code"
                      },
                      "duracao": {
                        "type": "string",
                        "example": "50min"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID do psicólogo não informado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do psicólogo é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro ao buscar reuniões.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao buscar reuniões"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Atualiza os dados de uma consulta",
        "description": "Permite atualizar qualquer campo de uma consulta existente, exceto o ID.",
        "tags": [
          "Interno - Agendamentos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "id"
                ],
                "properties": {
                  "id": {
                    "type": "string",
                    "example": "consulta_12345"
                  },
                  "pacienteId": {
                    "type": "string",
                    "example": "user_12345"
                  },
                  "name": {
                    "type": "string",
                    "example": "João Silva"
                  },
                  "fantasy_name": {
                    "type": "string",
                    "example": "Clínica Exemplo"
                  },
                  "psicologoId": {
                    "type": "string",
                    "example": "psico_98765"
                  },
                  "data": {
                    "type": "string",
                    "format": "date",
                    "example": "2025-11-20"
                  },
                  "hora": {
                    "type": "string",
                    "example": "14:30"
                  },
                  "tipo_consulta": {
                    "type": "string",
                    "example": "Online"
                  },
                  "observacao": {
                    "type": "string",
                    "example": "Consulta de avaliação inicial"
                  },
                  "recorrencia": {
                    "type": "string",
                    "example": "Semanal"
                  },
                  "duracao": {
                    "type": "number",
                    "example": 50
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Consulta atualizada com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "pacienteId": {
                      "type": "string"
                    },
                    "name": {
                      "type": "string"
                    },
                    "fantasy_name": {
                      "type": "string"
                    },
                    "psicologoId": {
                      "type": "string"
                    },
                    "data": {
                      "type": "string"
                    },
                    "hora": {
                      "type": "string"
                    },
                    "tipo_consulta": {
                      "type": "string"
                    },
                    "observacao": {
                      "type": "string"
                    },
                    "recorrencia": {
                      "type": "string"
                    },
                    "code": {
                      "type": "string"
                    },
                    "duracao": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro ao atualizar a consulta.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao atualizar reunião"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Exclui uma consulta existente",
        "description": "Remove do banco de dados uma consulta específica pelo seu ID.",
        "tags": [
          "Interno - Consultas"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "id"
                ],
                "properties": {
                  "id": {
                    "type": "string",
                    "example": "consulta_12345"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Consulta deletada com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Reunião deletada com sucesso"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro ao deletar a consulta.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao deletar reunião"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/gerar-link-anamnese": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Gera um link temporário de acesso à anamnese",
        "description": "Cria um token temporário para o psicólogo acessar a anamnese de forma segura e retorna o link completo.",
        "tags": [
          "Interno - Anamnese"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "psicologoId"
                ],
                "properties": {
                  "psicologoId": {
                    "type": "string",
                    "example": "psico_98765"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Link gerado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "link": {
                      "type": "string",
                      "example": "https://meusite.com/amnp/psico_98765/123e4567-e89b-12d3-a456-426614174000"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetros obrigatórios não informados.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Campos obrigatórios: psicologoId"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor ao gerar o link.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno do servidor"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/history": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Adiciona um registro ao histórico de um psicólogo",
        "description": "Cria um novo registro no histórico de um psicólogo, com descrição, tipo e timestamp.",
        "tags": [
          "Interno - Histórico"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "psicologoId",
                  "descricao"
                ],
                "properties": {
                  "psicologoId": {
                    "type": "string",
                    "example": "psico_98765"
                  },
                  "descricao": {
                    "type": "string",
                    "example": "Consulta realizada com sucesso"
                  },
                  "tipo": {
                    "type": "string",
                    "example": "geral"
                  },
                  "timestamp": {
                    "type": "string",
                    "format": "date-time",
                    "example": "2025-11-20T14:30:00Z"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Histórico criado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "example": "hist_123456"
                    },
                    "psicologoId": {
                      "type": "string"
                    },
                    "descricao": {
                      "type": "string"
                    },
                    "tipo": {
                      "type": "string"
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetros obrigatórios não informados.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "psicologoId e descricao são obrigatórios"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao salvar histórico.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno ao salvar histórico"
                    },
                    "details": {
                      "type": "string",
                      "example": "Mensagem de erro detalhada do servidor"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Lista o histórico de um psicólogo",
        "description": "Retorna todos os registros do histórico de um psicólogo, ordenados do mais recente para o mais antigo.",
        "tags": [
          "Interno - Histórico"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "psicologoId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do psicólogo cujos registros serão retornados."
          }
        ],
        "responses": {
          "200": {
            "description": "Histórico retornado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string",
                        "example": "hist_123456"
                      },
                      "psicologoId": {
                        "type": "string"
                      },
                      "descricao": {
                        "type": "string",
                        "example": "Consulta realizada com sucesso"
                      },
                      "tipo": {
                        "type": "string",
                        "example": "geral"
                      },
                      "timestamp": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2025-11-20T14:30:00Z"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetro psicologoId não informado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "psicologoId é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro ao buscar histórico.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao buscar histórico"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Deleta um registro do histórico de um psicólogo",
        "description": "Remove um registro do histórico com base no ID fornecido.",
        "tags": [
          "Interno - Histórico"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do registro de histórico a ser deletado."
          }
        ],
        "responses": {
          "200": {
            "description": "Histórico deletado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Histórico deletado com sucesso"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID do histórico não informado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do histórico é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro ao deletar o histórico.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao deletar histórico"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/insight/generate-anamnese": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Gera uma análise de anamnese usando IA",
        "description": "Recebe respostas do usuário, gera um prompt para análise psicológica e retorna a resposta do modelo de IA.",
        "tags": [
          "Interno - IA / Anamnese"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do usuário que irá consumir crédito"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "object",
                    "description": "Objeto contendo as respostas fornecidas pelo paciente",
                    "example": {
                      "pergunta1": "Tenho dificuldades para dormir",
                      "pergunta2": "Ando muito ansioso"
                    }
                  }
                },
                "required": [
                  "message"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Resposta gerada pela IA",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "response": {
                      "type": "string",
                      "example": "Com base nas informações, é possível observar sinais de ansiedade..."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro de requisição (dados ausentes)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Mensagem não fornecida."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao gerar a resposta",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao gerar resposta do modelo."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/insight/generateResume": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Gera um resumo de livro usando IA",
        "description": "Recebe o título e o autor do livro, gera um prompt e retorna um resumo criado pela IA.",
        "tags": [
          "Interno - IA / Livros"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do usuário que consumirá crédito"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "titulo": {
                    "type": "string",
                    "description": "Título do livro",
                    "example": "O Poder do Hábito"
                  },
                  "autor": {
                    "type": "string",
                    "description": "Autor do livro",
                    "example": "Charles Duhigg"
                  }
                },
                "required": [
                  "titulo",
                  "autor"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Resumo gerado pela IA",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "result": {
                      "type": "string",
                      "example": "O livro explica como os hábitos funcionam e como podem ser transformados..."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro por dados ausentes",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Título e autor são obrigatórios."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao gerar resposta",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao gerar resposta do modelo."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/insight/psicochat": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Gera texto clínico baseado na transcrição e informações do paciente usando IA",
        "description": "Recebe transcrição, modelo, nome do psicólogo, CRP e nome do paciente. Gera texto estruturado com base no modelo informado.",
        "tags": [
          "Interno - IA / Documentos Clínicos"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do usuário responsável pela geração e consumo de créditos"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "description": "Transcrição recebida (texto base)",
                    "example": "Paciente relata ansiedade frequente e dificuldade para dormir..."
                  },
                  "prompt": {
                    "type": "string",
                    "description": "Modelo de documento desejado, por exemplo: relatório, evolução, anamnese",
                    "example": "modelo_evolucao"
                  },
                  "nomePaciente": {
                    "type": "string",
                    "description": "Nome do paciente",
                    "example": "João Silva"
                  },
                  "nomePsicologo": {
                    "type": "string",
                    "description": "Nome do psicólogo",
                    "example": "Dra. Ana Souza"
                  },
                  "crpPsicologo": {
                    "type": "string",
                    "description": "Número do CRP do psicólogo",
                    "example": "CRP-12/12345"
                  }
                },
                "required": [
                  "message",
                  "prompt",
                  "nomePaciente",
                  "nomePsicologo",
                  "crpPsicologo"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Texto clínico gerado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "response": {
                      "type": "string",
                      "example": "Paciente apresentou evolução positiva..."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro por parâmetros insuficientes ou créditos indisponíveis",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Creditos insuficientes ou invalidos, favor verificar seu saldo."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao gerar o texto com IA",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao gerar resposta do modelo."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/location-verification": {
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Consulta o status de pagamento de uma ordem",
        "description": "Retorna o status de pagamento de uma ordem consultando a API do Pagar.me.",
        "tags": [
          "Interno - Pagamentos"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "orderId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID da ordem a ser consultada no Pagar.me."
          }
        ],
        "responses": {
          "200": {
            "description": "Status de pagamento retornado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "paid"
                    },
                    "orderId": {
                      "type": "string",
                      "example": "order_123456"
                    },
                    "order": {
                      "type": "object",
                      "description": "Retorna o objeto completo da ordem conforme API do Pagar.me"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetro orderId não informado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "orderId é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao consultar status ou chave da API não configurada.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno ao consultar status"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/payments/compra-status": {
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Consulta o status de uma compra",
        "description": "Retorna o status e informações de uma compra específica com base no userId e paymentId.",
        "tags": [
          "Interno - Pagamentos"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do usuário relacionado à compra"
          },
          {
            "in": "query",
            "name": "paymentId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do pagamento gerado no checkout"
          }
        ],
        "responses": {
          "200": {
            "description": "Status da compra encontrado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "PAID"
                    },
                    "compra": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "4fd872ab91"
                        },
                        "Status": {
                          "type": "string",
                          "example": "PAID"
                        },
                        "qtdCreditos": {
                          "type": "integer",
                          "example": 20
                        },
                        "createdAt": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "updatedAt": {
                          "type": "string",
                          "format": "date-time"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetros obrigatórios ausentes",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Parâmetros 'userId' e 'paymentId' são obrigatórios."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Compra não encontrada",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Compra não encontrada para os parâmetros fornecidos."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro ao consultar status da compra",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao buscar status da compra."
                    },
                    "details": {
                      "type": "string",
                      "example": "Error: conexão com banco falhou"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/payments/credit-card": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Cria uma cobrança via cartão de crédito usando Pagar.me",
        "description": "Realiza a criação de uma ordem e pagamento por cartão de crédito diretamente via API do Pagar.me.",
        "tags": [
          "Interno - Pagamentos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "card_number",
                  "card_holder_name",
                  "card_expiration_date",
                  "card_cvv",
                  "customer",
                  "items"
                ],
                "properties": {
                  "card_number": {
                    "type": "string",
                    "example": "4111111111111111"
                  },
                  "card_holder_name": {
                    "type": "string",
                    "example": "João da Silva"
                  },
                  "card_expiration_date": {
                    "type": "string",
                    "example": "1229"
                  },
                  "card_cvv": {
                    "type": "string",
                    "example": "123"
                  },
                  "customer": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string",
                        "example": "João Silva"
                      },
                      "email": {
                        "type": "string",
                        "example": "joao@email.com"
                      },
                      "document": {
                        "type": "string",
                        "example": "12345678900"
                      },
                      "address": {
                        "type": "object",
                        "properties": {
                          "street": {
                            "type": "string",
                            "example": "Rua A"
                          },
                          "number": {
                            "type": "string",
                            "example": "123"
                          },
                          "neighborhood": {
                            "type": "string",
                            "example": "Centro"
                          },
                          "city": {
                            "type": "string",
                            "example": "São Paulo"
                          },
                          "state": {
                            "type": "string",
                            "example": "SP"
                          },
                          "zipCode": {
                            "type": "string",
                            "example": "01000000"
                          }
                        }
                      },
                      "phones": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "countryCode": {
                              "type": "string",
                              "example": "55"
                            },
                            "areaCode": {
                              "type": "string",
                              "example": "11"
                            },
                            "number": {
                              "type": "string",
                              "example": "987654321"
                            }
                          }
                        }
                      }
                    }
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": [
                        "code",
                        "quantity",
                        "unit_price"
                      ],
                      "properties": {
                        "code": {
                          "type": "string",
                          "example": "PROD001"
                        },
                        "description": {
                          "type": "string",
                          "example": "Créditos de IA"
                        },
                        "quantity": {
                          "type": "integer",
                          "example": 1
                        },
                        "unit_price": {
                          "type": "number",
                          "example": 1990
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Pagamento criado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "order": {
                      "type": "object",
                      "example": {
                        "id": "ord_123",
                        "status": "paid",
                        "amount": 1990
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Dados incompletos ou inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Dados incompletos"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao criar cobrança",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao processar pagamento."
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Teste de funcionamento da API de pagamentos",
        "description": "Retorna uma mensagem simples indicando que a API está ativa.",
        "tags": [
          "Interno - Pagamentos"
        ],
        "responses": {
          "200": {
            "description": "API funcionando corretamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "API de pagamentos está funcionando!"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/payments/pix": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Cria uma cobrança PIX via Pagar.me",
        "description": "Gera uma ordem de pagamento PIX no Pagar.me e retorna o QR Code e dados da transação.",
        "tags": [
          "Interno - Pagamentos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "customer": {
                    "type": "object",
                    "description": "Dados do comprador",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "email": {
                        "type": "string"
                      },
                      "document": {
                        "type": "string",
                        "description": "CPF do cliente"
                      },
                      "address": {
                        "type": "object",
                        "properties": {
                          "street": {
                            "type": "string"
                          },
                          "number": {
                            "type": "string"
                          },
                          "neighborhood": {
                            "type": "string"
                          },
                          "city": {
                            "type": "string"
                          },
                          "state": {
                            "type": "string"
                          },
                          "zipCode": {
                            "type": "string"
                          }
                        }
                      },
                      "phones": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "countryCode": {
                              "type": "string"
                            },
                            "areaCode": {
                              "type": "string"
                            },
                            "number": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  },
                  "items": {
                    "type": "array",
                    "description": "Lista de produtos ou créditos",
                    "items": {
                      "type": "object",
                      "properties": {
                        "code": {
                          "type": "string"
                        },
                        "description": {
                          "type": "string"
                        },
                        "quantity": {
                          "type": "integer"
                        },
                        "unit_price": {
                          "type": "number"
                        },
                        "price": {
                          "type": "number"
                        }
                      }
                    }
                  }
                },
                "required": [
                  "customer",
                  "items"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "PIX criado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "order": {
                      "type": "object",
                      "description": "Retorno completo da API da Pagar.me"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Dados ausentes ou inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao gerar o PIX",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Verifica se a API de pagamentos está funcionando",
        "description": "Retorna uma mensagem simples confirmando o funcionamento da API.",
        "tags": [
          "Interno - Pagamentos"
        ],
        "responses": {
          "200": {
            "description": "API funcionando corretamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "API de pagamentos está funcionando!"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/payments/savepay": {
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Lista as compras de um usuário",
        "description": "Retorna todas as compras associadas a um usuário, ordenadas da mais recente para a mais antiga.",
        "tags": [
          "Interno - Pagamentos"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do usuário para buscar compras"
          }
        ],
        "responses": {
          "200": {
            "description": "Compras encontradas com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "compras": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "userId": {
                            "type": "string"
                          },
                          "Status": {
                            "type": "string",
                            "example": "PAID"
                          },
                          "qtdCreditos": {
                            "type": "number",
                            "example": 10
                          },
                          "paymentId": {
                            "type": "string"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "userId não fornecido",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "userId é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao buscar compras",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno ao buscar compras"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Salva uma compra/pagamento no sistema",
        "description": "Registra uma nova compra no banco de dados com status e créditos adquiridos.",
        "tags": [
          "Interno - Pagamentos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "userId": {
                    "type": "string",
                    "description": "ID do usuário que realizou a compra"
                  },
                  "paymentId": {
                    "type": "string",
                    "description": "ID do pagamento gerado pelo gateway"
                  },
                  "stats": {
                    "type": "string",
                    "description": "Status da compra (PENDING, FAILED, PAID)",
                    "example": "PENDING"
                  },
                  "qtdCreditos": {
                    "type": "number",
                    "description": "Quantidade de créditos adquiridos"
                  }
                },
                "required": [
                  "userId",
                  "paymentId"
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Compra registrada com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "compra": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "userId": {
                          "type": "string"
                        },
                        "paymentId": {
                          "type": "string"
                        },
                        "Status": {
                          "type": "string",
                          "example": "PENDING"
                        },
                        "qtdCreditos": {
                          "type": "number",
                          "example": 10
                        },
                        "createdAt": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "updatedAt": {
                          "type": "string",
                          "format": "date-time"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetros obrigatórios ausentes",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "userId e paymentId são obrigatórios"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao criar compra",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno ao criar compra"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Remove uma compra salva pelo paymentId",
        "description": "Deleta todas as compras associadas ao paymentId informado.",
        "tags": [
          "Interno - Pagamentos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "paymentId": {
                    "type": "string",
                    "description": "ID do pagamento a ser removido"
                  }
                },
                "required": [
                  "paymentId"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Compras deletadas com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "deletedCount": {
                      "type": "number",
                      "description": "Quantidade de registros removidos",
                      "example": 1
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "paymentId ausente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "paymentId é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Nenhuma compra encontrada para o paymentId informado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Nenhuma compra encontrada para esse paymentId"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao deletar compra",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno ao deletar compra"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/products": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Cadastra um novo produto",
        "description": "Cria um produto com código, título, descrição, preço, valor unitário e quantidade.",
        "tags": [
          "Interno - Produtos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "codigo",
                  "titulo",
                  "preco",
                  "valorUn",
                  "quantidade"
                ],
                "properties": {
                  "codigo": {
                    "type": "string",
                    "example": "PROD001"
                  },
                  "titulo": {
                    "type": "string",
                    "example": "Curso de Psicologia"
                  },
                  "descricao": {
                    "type": "string",
                    "example": "Curso avançado de psicologia clínica"
                  },
                  "preco": {
                    "type": "number",
                    "example": 150
                  },
                  "valorUn": {
                    "type": "number",
                    "example": 150
                  },
                  "quantidade": {
                    "type": "number",
                    "example": 10
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Produto cadastrado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "example": "prod_123456"
                    },
                    "codigo": {
                      "type": "string"
                    },
                    "titulo": {
                      "type": "string"
                    },
                    "descricao": {
                      "type": "string"
                    },
                    "preco": {
                      "type": "number"
                    },
                    "valorUn": {
                      "type": "number"
                    },
                    "quantidade": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Campos obrigatórios ausentes.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Campos obrigatórios ausentes"
                    }
                  }
                }
              }
            }
          },
          "409": {
            "description": "Código de produto já cadastrado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Código de produto já cadastrado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao cadastrar produto.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao cadastrar produto"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Lista todos os produtos",
        "description": "Retorna todos os produtos cadastrados, ordenados do mais recente para o mais antigo.",
        "tags": [
          "Interno - Produtos"
        ],
        "responses": {
          "200": {
            "description": "Lista de produtos retornada com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string",
                        "example": "prod_123456"
                      },
                      "codigo": {
                        "type": "string",
                        "example": "PROD001"
                      },
                      "titulo": {
                        "type": "string",
                        "example": "Curso de Psicologia"
                      },
                      "descricao": {
                        "type": "string",
                        "example": "Curso avançado de psicologia clínica"
                      },
                      "preco": {
                        "type": "number",
                        "example": 150
                      },
                      "valorUn": {
                        "type": "number",
                        "example": 150
                      },
                      "quantidade": {
                        "type": "number",
                        "example": 10
                      },
                      "createdAt": {
                        "type": "string",
                        "format": "date-time"
                      },
                      "updatedAt": {
                        "type": "string",
                        "format": "date-time"
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao listar produtos.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao listar produtos"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Atualiza um produto existente",
        "description": "Atualiza os dados de um produto cadastrado com base no ID fornecido.",
        "tags": [
          "Interno - Produtos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "id",
                  "codigo",
                  "titulo",
                  "descricao",
                  "preco",
                  "valorUn",
                  "quantidade"
                ],
                "properties": {
                  "id": {
                    "type": "string",
                    "example": "prod_123456"
                  },
                  "codigo": {
                    "type": "string",
                    "example": "PROD001"
                  },
                  "titulo": {
                    "type": "string",
                    "example": "Curso de Psicologia"
                  },
                  "descricao": {
                    "type": "string",
                    "example": "Curso avançado de psicologia clínica"
                  },
                  "preco": {
                    "type": "number",
                    "example": 150
                  },
                  "valorUn": {
                    "type": "number",
                    "example": 150
                  },
                  "quantidade": {
                    "type": "number",
                    "example": 10
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Produto atualizado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "codigo": {
                      "type": "string"
                    },
                    "titulo": {
                      "type": "string"
                    },
                    "descricao": {
                      "type": "string"
                    },
                    "preco": {
                      "type": "number"
                    },
                    "valorUn": {
                      "type": "number"
                    },
                    "quantidade": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Dados incompletos para atualização.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Envie todos os dados para edição do produto"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao atualizar produto.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao atualizar produto"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Remove um produto",
        "description": "Deleta um produto existente a partir do código informado como parâmetro de query.",
        "tags": [
          "Interno - Produtos"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "codigo",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "Código do produto a ser deletado"
          }
        ],
        "responses": {
          "200": {
            "description": "Produto removido com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Código do produto não fornecido.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Código do produto é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao deletar produto.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao deletar produto"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/prontuario/analise-paciente": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Gera uma avaliação baseada no prompt enviado",
        "description": "Recebe um prompt, concatena com instruções internas e envia ao modelo de IA para gerar uma avaliação estruturada.",
        "tags": [
          "Interno - Avaliações"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "prompt"
                ],
                "properties": {
                  "prompt": {
                    "type": "string",
                    "example": "Paciente demonstra sinais de melhora no tratamento."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Avaliação gerada com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "result": {
                      "type": "string",
                      "example": "Avaliação detalhada gerada pelo modelo."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro — campo prompt não enviado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Título e autor são obrigatórios."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao gerar resposta do modelo",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao gerar resposta do modelo."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/prontuario": {
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Retorna o prontuário de um paciente",
        "description": "Busca um prontuário usando o pacienteId informado na URL.",
        "tags": [
          "Interno - Prontuário"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "pacienteId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do paciente associado ao prontuário"
          }
        ],
        "responses": {
          "200": {
            "description": "Prontuário encontrado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          },
          "400": {
            "description": "pacienteId não informado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do paciente não informado"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Prontuário não encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Prontuário não encontrado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno do servidor"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Cria um prontuário para um paciente",
        "description": "Registra um novo prontuário vinculado a um paciente. Cada paciente só pode ter um prontuário.",
        "tags": [
          "Interno - Prontuário"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "pacienteId"
                ],
                "properties": {
                  "pacienteId": {
                    "type": "string",
                    "example": "cltxyz12345"
                  },
                  "queixaPrincipal": {
                    "type": "string",
                    "example": "Ansiedade constante e dificuldade para dormir."
                  },
                  "historico": {
                    "type": "string",
                    "example": "Paciente relata histórico de ansiedade desde a adolescência."
                  },
                  "conduta": {
                    "type": "string",
                    "example": "Aplicação de técnicas de respiração e exercícios cognitivos."
                  },
                  "transcription": {
                    "type": "string",
                    "example": "Transcrição da última sessão..."
                  },
                  "evolucao": {
                    "type": "string",
                    "example": "Paciente apresentou melhora após técnicas aplicadas."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Prontuário criado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          },
          "400": {
            "description": "Dados ausentes — pacienteId é obrigatório",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do paciente é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "409": {
            "description": "O paciente já possui prontuário registrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Paciente já possui prontuário"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao criar prontuário",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno ao criar prontuário"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Atualiza o prontuário de um paciente",
        "description": "Atualiza os campos do prontuário existente. Caso um campo não seja enviado, o valor atual é mantido. O campo \"evolucao\" é concatenado ao valor anterior.",
        "tags": [
          "Interno - Prontuário"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "pacienteId"
                ],
                "properties": {
                  "pacienteId": {
                    "type": "string",
                    "example": "cltxyz12345"
                  },
                  "queixaPrincipal": {
                    "type": "string",
                    "example": "Paciente relata melhora nos sintomas de ansiedade."
                  },
                  "historico": {
                    "type": "string",
                    "example": "Histórico atualizado conforme sessão mais recente."
                  },
                  "conduta": {
                    "type": "string",
                    "example": "Aplicação de nova técnica cognitiva."
                  },
                  "transcription": {
                    "type": "string",
                    "example": "Transcrição atualizada da sessão."
                  },
                  "evolucao": {
                    "type": "string",
                    "example": "Paciente demonstrou maior controle emocional na sessão."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Prontuário atualizado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          },
          "400": {
            "description": "Erro – pacienteId não enviado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do paciente é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Prontuário não encontrado para o paciente informado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Prontuário não encontrado para o paciente"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao atualizar prontuário",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno ao atualizar prontuário"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/prontuario/save-transcription": {
      "put": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Atualiza e concatena uma nova transcription ao prontuário do paciente",
        "description": "Busca o prontuário pelo pacienteId e adiciona uma nova entrada de transcription concatenada com as anteriores.",
        "tags": [
          "Interno - Prontuário"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "pacienteId",
                  "transcription"
                ],
                "properties": {
                  "pacienteId": {
                    "type": "string",
                    "description": "ID do paciente associado ao prontuário",
                    "example": "user_123"
                  },
                  "transcription": {
                    "type": "string",
                    "description": "Texto da nova transcrição a ser adicionada",
                    "example": "Paciente relatou melhora no humor após início da medicação."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Transcription atualizada com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "example": {
                    "pacienteId": "user_123",
                    "transcription": "Transcrição antiga...\n-- 20/11/2025\nNova transcrição"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro — parâmetros obrigatórios ausentes",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do paciente e transcription são obrigatórios"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Prontuário não encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Prontuário não encontrado para o paciente"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao atualizar transcription",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno ao atualizar transcription"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/register_admins": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Cadastra um novo usuário administrador",
        "description": "Cria um usuário com papel de ADMIN, realizando validação de campos e hash da senha.",
        "tags": [
          "Interno - Admin"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "email",
                  "password",
                  "confirmPassword",
                  "role"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "example": "Oscar Rodrigues"
                  },
                  "email": {
                    "type": "string",
                    "example": "admin@example.com"
                  },
                  "password": {
                    "type": "string",
                    "example": "senha123"
                  },
                  "confirmPassword": {
                    "type": "string",
                    "example": "senha123"
                  },
                  "role": {
                    "type": "string",
                    "example": "ADMIN"
                  },
                  "vinculo_admin": {
                    "type": "string",
                    "description": "ID de outro admin ao qual este usuário está vinculado (opcional)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Admin cadastrado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Admin cadastrado com sucesso"
                    },
                    "user": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        },
                        "email": {
                          "type": "string"
                        },
                        "role": {
                          "type": "string"
                        },
                        "vinculo_admin": {
                          "type": "string"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro de validação de campos.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Nome, email, senha e confirmação de senha são obrigatórios"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao cadastrar admin.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Erro ao cadastrar admin"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/register_pacientes/pre-pacientes": {
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Lista pré-pacientes ainda não habilitados de um psicólogo",
        "description": "Retorna todos os registros de pré-pacientes vinculados ao psicólogo informado, filtrando apenas os não habilitados.",
        "tags": [
          "Interno - Pré-Pacientes"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "psicologoId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do psicólogo responsável",
            "example": "clu1x0a9g0001z0t7i1s2abc"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de pré-pacientes retornada com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string",
                        "example": "prp_123"
                      },
                      "nome": {
                        "type": "string",
                        "example": "Maria Oliveira"
                      },
                      "email": {
                        "type": "string",
                        "example": "maria@email.com"
                      },
                      "endereco": {
                        "type": "string",
                        "example": "Rua das Flores, 123"
                      },
                      "nascimento": {
                        "type": "string",
                        "example": "1995-08-12"
                      },
                      "idade": {
                        "type": "number",
                        "example": 29
                      },
                      "cpf": {
                        "type": "string",
                        "example": "12345678900"
                      },
                      "telefone": {
                        "type": "string",
                        "example": "27999998888"
                      },
                      "emergencia": {
                        "type": "string",
                        "example": "Mãe - 27988887777"
                      },
                      "generoOrientacao": {
                        "type": "string",
                        "example": "Feminino"
                      },
                      "estadoCivil": {
                        "type": "string",
                        "example": "Solteira"
                      },
                      "origemConhecimento": {
                        "type": "string",
                        "example": "Instagram"
                      },
                      "preocupacao": {
                        "type": "string",
                        "example": "Ansiedade constante"
                      },
                      "motivoAtendimento": {
                        "type": "string",
                        "example": "Crises de ansiedade"
                      },
                      "experienciaAnterior": {
                        "type": "string",
                        "example": "Já fez terapia 1 ano"
                      },
                      "saudeFisica": {
                        "type": "string",
                        "example": "Boa"
                      },
                      "detalhesSaudeFisica": {
                        "type": "string",
                        "example": "Sem condições graves"
                      },
                      "medicamentos": {
                        "type": "string",
                        "example": "Nenhum"
                      },
                      "diagnosticoMental": {
                        "type": "string",
                        "example": "Não possui"
                      },
                      "historicoFamiliar": {
                        "type": "string",
                        "example": "Histórico de ansiedade na família"
                      },
                      "rotina": {
                        "type": "string",
                        "example": "Trabalho intenso, pouco lazer"
                      },
                      "sono": {
                        "type": "string",
                        "example": "Dorme 5h por noite"
                      },
                      "atividadeFisica": {
                        "type": "string",
                        "example": "Raramente"
                      },
                      "estresse": {
                        "type": "string",
                        "example": "Alto"
                      },
                      "convivencia": {
                        "type": "string",
                        "example": "Boa"
                      },
                      "relacaoFamiliar": {
                        "type": "string",
                        "example": "Distante"
                      },
                      "apoioSocial": {
                        "type": "string",
                        "example": "Poucos amigos"
                      },
                      "nivelFelicidade": {
                        "type": "number",
                        "example": 4
                      },
                      "ansiedade": {
                        "type": "number",
                        "example": 8
                      },
                      "pensamentosNegativos": {
                        "type": "string",
                        "example": "Constantes"
                      },
                      "objetivoTerapia": {
                        "type": "string",
                        "example": "Melhorar crises de ansiedade"
                      },
                      "temasDelicados": {
                        "type": "string",
                        "example": "Relacionamentos"
                      },
                      "estiloAtendimento": {
                        "type": "string",
                        "example": "Acolhedor"
                      },
                      "observacoesFinais": {
                        "type": "string",
                        "example": "Paciente muito retraída"
                      },
                      "autorizacaoLGPD": {
                        "type": "boolean",
                        "example": true
                      },
                      "habilitado": {
                        "type": "boolean",
                        "example": false
                      },
                      "createdAt": {
                        "type": "string",
                        "example": "2025-01-10T12:34:56.000Z"
                      },
                      "updatedAt": {
                        "type": "string",
                        "example": "2025-01-10T14:21:00.000Z"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID do psicólogo não informado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do psicólogo é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao buscar pré-pacientes",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno do servidor"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/register_pacientes": {
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Lista todos os pacientes vinculados a um psicólogo",
        "description": "Retorna todos os pacientes associados ao psicólogo informado via query string.",
        "tags": [
          "Interno - Pacientes"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "psicologoId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do psicólogo",
            "example": "user_123"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de pacientes retornada com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "nome": {
                        "type": "string"
                      },
                      "fantasy_name": {
                        "type": "string"
                      },
                      "idade": {
                        "type": "number"
                      },
                      "telefone": {
                        "type": "string"
                      },
                      "cidade": {
                        "type": "string"
                      },
                      "estado": {
                        "type": "string"
                      },
                      "convenio": {
                        "type": "string"
                      },
                      "cpf": {
                        "type": "string"
                      },
                      "sexo": {
                        "type": "string"
                      },
                      "cep": {
                        "type": "string"
                      },
                      "bairro": {
                        "type": "string"
                      },
                      "numero": {
                        "type": "string"
                      },
                      "pais": {
                        "type": "string"
                      },
                      "complemento": {
                        "type": "string"
                      },
                      "email": {
                        "type": "string"
                      },
                      "rg": {
                        "type": "string"
                      },
                      "sintomas": {
                        "type": "string"
                      },
                      "rua": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Falta de parâmetros obrigatórios",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do psicólogo é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao buscar pacientes",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao buscar pacientes"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Cria um novo paciente e gera automaticamente o prontuário inicial",
        "description": "Cria um paciente no sistema e já vincula um prontuário com dados iniciais.",
        "tags": [
          "Interno - Pacientes"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "nome",
                  "fantasy_name",
                  "sintomas",
                  "telefone",
                  "convenio",
                  "cpf",
                  "sexo",
                  "cep",
                  "cidade",
                  "bairro",
                  "rua",
                  "numero",
                  "pais",
                  "estado",
                  "email",
                  "rg",
                  "psicologoId"
                ],
                "properties": {
                  "nome": {
                    "type": "string"
                  },
                  "fantasy_name": {
                    "type": "string"
                  },
                  "idade": {
                    "type": "number",
                    "nullable": true
                  },
                  "sintomas": {
                    "type": "string"
                  },
                  "telefone": {
                    "type": "string"
                  },
                  "convenio": {
                    "type": "string"
                  },
                  "cpf": {
                    "type": "string"
                  },
                  "sexo": {
                    "type": "string"
                  },
                  "cep": {
                    "type": "string"
                  },
                  "cidade": {
                    "type": "string"
                  },
                  "bairro": {
                    "type": "string"
                  },
                  "rua": {
                    "type": "string"
                  },
                  "numero": {
                    "type": "string"
                  },
                  "pais": {
                    "type": "string"
                  },
                  "complemento": {
                    "type": "string",
                    "nullable": true
                  },
                  "estado": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "rg": {
                    "type": "string"
                  },
                  "psicologoId": {
                    "type": "string"
                  },
                  "resumo_anmp": {
                    "type": "string",
                    "nullable": true
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Paciente criado com sucesso junto ao prontuário inicial",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "example": {
                    "message": "Paciente e prontuário criados com sucesso",
                    "data": {
                      "id": "pac_abc123",
                      "nome": "Maria Souza",
                      "cpf": "12345678900",
                      "psicologoId": "user_123",
                      "prontuario": {
                        "id": "pront_1",
                        "queixaPrincipal": "Ansiedade constante",
                        "historico": "Prontuário inicial criado automaticamente.",
                        "conduta": null,
                        "evolucao": null
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro de validação — campos obrigatórios ausentes",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Todos os campos obrigatórios devem ser preenchidos"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao criar paciente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao processar a requisição"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Remove um paciente e seu prontuário vinculado",
        "description": "Deleta um paciente pelo ID. Caso exista um prontuário associado, ele será removido automaticamente.",
        "tags": [
          "Interno - Pacientes"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do paciente a ser deletado"
          }
        ],
        "responses": {
          "200": {
            "description": "Paciente removido com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "example": {
                    "message": "Paciente deletado com sucesso"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro — ID não informado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do paciente é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Paciente não encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Paciente não encontrado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao deletar paciente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao deletar paciente"
                    },
                    "details": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Atualiza os dados de um paciente",
        "description": "Atualiza qualquer campo do paciente a partir do ID informado. Apenas os campos enviados no corpo serão alterados.",
        "tags": [
          "Interno - Pacientes"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string",
                    "example": "clu1x0a9g0001z0t7i1s2abc"
                  },
                  "nome": {
                    "type": "string",
                    "example": "João da Silva"
                  },
                  "fantasy_name": {
                    "type": "string",
                    "example": "João S."
                  },
                  "idade": {
                    "type": "number",
                    "example": 32
                  },
                  "telefone": {
                    "type": "string",
                    "example": "27999998888"
                  },
                  "sintomas": {
                    "type": "string",
                    "example": "Ansiedade e insônia"
                  },
                  "convenio": {
                    "type": "string",
                    "example": "SulAmérica"
                  },
                  "cpf": {
                    "type": "string",
                    "example": "12345678900"
                  },
                  "sexo": {
                    "type": "string",
                    "example": "Masculino"
                  },
                  "cidade": {
                    "type": "string",
                    "example": "Vitória"
                  },
                  "estado": {
                    "type": "string",
                    "example": "ES"
                  },
                  "email": {
                    "type": "string",
                    "example": "joao@email.com"
                  },
                  "rg": {
                    "type": "string",
                    "example": "11223344"
                  },
                  "resumo_anmp": {
                    "type": "string",
                    "example": "Paciente demonstra sinais leves de ansiedade."
                  }
                },
                "required": [
                  "id"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Paciente atualizado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "example": {
                    "id": "clu1x0a9g0001z0t7i1s2abc",
                    "nome": "João da Silva",
                    "telefone": "27999998888",
                    "cidade": "Vitória"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro — ID não informado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do paciente é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Paciente não encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Paciente não encontrado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao atualizar paciente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao atualizar paciente"
                    },
                    "details": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/register_pacientes/transform": {
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Busca um pré-paciente pelo ID",
        "description": "Retorna as informações completas de um pré-paciente específico.",
        "tags": [
          "Interno - Pré-Pacientes"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "idpac",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do pré-paciente",
            "example": "prp_abc123"
          }
        ],
        "responses": {
          "200": {
            "description": "Pré-paciente encontrado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "example": "prp_abc123"
                    },
                    "nome": {
                      "type": "string",
                      "example": "João Silva"
                    },
                    "email": {
                      "type": "string",
                      "example": "joao@mail.com"
                    },
                    "endereco": {
                      "type": "string",
                      "example": "Rua Flores, 100"
                    },
                    "nascimento": {
                      "type": "string",
                      "example": "1990-02-17"
                    },
                    "idade": {
                      "type": "number",
                      "example": 34
                    },
                    "cpf": {
                      "type": "string",
                      "example": "12345678900"
                    },
                    "telefone": {
                      "type": "string",
                      "example": "27999998888"
                    },
                    "emergencia": {
                      "type": "string",
                      "example": "Maria - 27999997777"
                    },
                    "generoOrientacao": {
                      "type": "string",
                      "example": "Masculino"
                    },
                    "estadoCivil": {
                      "type": "string",
                      "example": "Solteiro"
                    },
                    "origemConhecimento": {
                      "type": "string",
                      "example": "Indicação"
                    },
                    "preocupacao": {
                      "type": "string",
                      "example": "Ansiedade"
                    },
                    "motivoAtendimento": {
                      "type": "string",
                      "example": "Crises recorrentes"
                    },
                    "experienciaAnterior": {
                      "type": "string",
                      "example": "Nunca fez terapia"
                    },
                    "saudeFisica": {
                      "type": "string",
                      "example": "Boa"
                    },
                    "detalhesSaudeFisica": {
                      "type": "string",
                      "example": "Sem observações"
                    },
                    "medicamentos": {
                      "type": "string",
                      "example": "Nenhum"
                    },
                    "diagnosticoMental": {
                      "type": "string",
                      "example": "Nenhum"
                    },
                    "historicoFamiliar": {
                      "type": "string",
                      "example": "Ansiedade na mãe"
                    },
                    "rotina": {
                      "type": "string",
                      "example": "Trabalho intenso"
                    },
                    "sono": {
                      "type": "string",
                      "example": "Dorme 6h/dia"
                    },
                    "atividadeFisica": {
                      "type": "string",
                      "example": "Sedentário"
                    },
                    "estresse": {
                      "type": "string",
                      "example": "Alto"
                    },
                    "convivencia": {
                      "type": "string",
                      "example": "Boa"
                    },
                    "relacaoFamiliar": {
                      "type": "string",
                      "example": "Neutra"
                    },
                    "apoioSocial": {
                      "type": "string",
                      "example": "Poucos amigos"
                    },
                    "nivelFelicidade": {
                      "type": "number",
                      "example": 5
                    },
                    "ansiedade": {
                      "type": "number",
                      "example": 8
                    },
                    "pensamentosNegativos": {
                      "type": "string",
                      "example": "Frequentes"
                    },
                    "objetivoTerapia": {
                      "type": "string",
                      "example": "Controle emocional"
                    },
                    "temasDelicados": {
                      "type": "string",
                      "example": "Relacionamento"
                    },
                    "estiloAtendimento": {
                      "type": "string",
                      "example": "Direto e acolhedor"
                    },
                    "observacoesFinais": {
                      "type": "string",
                      "example": "Paciente retraído"
                    },
                    "autorizacaoLGPD": {
                      "type": "boolean",
                      "example": true
                    },
                    "habilitado": {
                      "type": "boolean",
                      "example": false
                    },
                    "psicologoId": {
                      "type": "string",
                      "example": "psi_777aaa"
                    },
                    "createdAt": {
                      "type": "string",
                      "example": "2025-01-10T10:15:00.000Z"
                    },
                    "updatedAt": {
                      "type": "string",
                      "example": "2025-01-10T12:20:00.000Z"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetro ausente ou inválido",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Parâmetro \"idpac\" ausente ou inválido"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Pré-paciente não encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "PrePaciente não encontrado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno no servidor"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Remove um pré-paciente pelo ID",
        "description": "Deleta permanentemente um registro de pré-paciente.",
        "tags": [
          "Interno - Pré-Pacientes"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "idpac",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do pré-paciente a ser removido",
            "example": "prp_abc123"
          }
        ],
        "responses": {
          "200": {
            "description": "Pré-paciente deletado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "PrePaciente removido com sucesso"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetro inválido ou ausente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Parâmetro \"idpac\" ausente ou inválido"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Pré-paciente não encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "PrePaciente não encontrado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno no servidor"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/token-calculator": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Calcula tokens e custo aproximado para uma requisição de modelo",
        "description": "Retorna a quantidade de tokens utilizados e o custo estimado em USD com base no modelo selecionado.",
        "tags": [
          "Interno - gpt token calculator"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "inputText",
                  "outputText",
                  "model"
                ],
                "properties": {
                  "inputText": {
                    "type": "string",
                    "description": "Texto de entrada enviado ao modelo",
                    "example": "Escreva um resumo sobre Next.js"
                  },
                  "outputText": {
                    "type": "string",
                    "description": "Texto esperado como resposta",
                    "example": "Next.js é um framework React para SSR e SSG."
                  },
                  "model": {
                    "type": "string",
                    "description": "Modelo utilizado para o cálculo",
                    "example": "gpt-4"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Retorna tokens e custo estimado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "model": {
                      "type": "string"
                    },
                    "promptTokens": {
                      "type": "number"
                    },
                    "completionTokens": {
                      "type": "number"
                    },
                    "totalTokens": {
                      "type": "number"
                    },
                    "costUSD": {
                      "type": "number",
                      "format": "float"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Requisição inválida ou modelo não suportado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "inputText, outputText e model são obrigatórios"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/upbook": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Cria um novo livro científico",
        "description": "Adiciona um livro à base científica, vinculando opcionalmente a um psicólogo.",
        "tags": [
          "Interno - Livros"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "autor",
                  "resumo"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Título do livro",
                    "example": "Psicologia Moderna"
                  },
                  "psicologoId": {
                    "type": "string",
                    "description": "ID do psicólogo associado (opcional)",
                    "example": "abc123"
                  },
                  "autor": {
                    "type": "string",
                    "description": "Nome do autor",
                    "example": "Sigmund Freud"
                  },
                  "url_capa": {
                    "type": "string",
                    "description": "URL da imagem de capa (opcional)",
                    "example": "https://example.com/capa.jpg"
                  },
                  "resumo": {
                    "type": "string",
                    "description": "Resumo do livro",
                    "example": "Este livro explora os conceitos fundamentais da psicologia moderna."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Livro criado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "name": {
                      "type": "string"
                    },
                    "psicologoId": {
                      "type": "string"
                    },
                    "autor": {
                      "type": "string"
                    },
                    "url_capa": {
                      "type": "string"
                    },
                    "resumo": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Campos obrigatórios ausentes",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Título, autor e resumo são obrigatórios"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno no servidor"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Lista livros científicos de um psicólogo",
        "description": "Retorna todos os livros científicos associados a um psicólogo específico.",
        "tags": [
          "Interno - Livros"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "psicologoId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do psicólogo"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de livros retornada com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string"
                      },
                      "psicologoId": {
                        "type": "string"
                      },
                      "autor": {
                        "type": "string"
                      },
                      "url_capa": {
                        "type": "string"
                      },
                      "resumo": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetro obrigatório ausente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Parâmetro 'psicologoId' é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno do servidor"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Deleta um livro científico pelo ID",
        "description": "Remove um livro específico do banco de dados usando seu ID.",
        "tags": [
          "Interno - Livros"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "bookId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do livro a ser deletado"
          }
        ],
        "responses": {
          "200": {
            "description": "Livro deletado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Livro deletado com sucesso"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetro obrigatório ausente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Parâmetro 'bookId' é obrigatório"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Livro não encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Livro não encontrado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno no servidor"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/uploads/capa": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Realiza upload de arquivos",
        "description": "Envia um arquivo em formato multipart/form-data e retorna a URL final após o upload.",
        "tags": [
          "Interno - files and uploads"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "path",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Caminho opcional onde o arquivo será salvo",
            "example": "pacientes/123"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "file"
                ],
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "Arquivo a ser enviado"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Upload realizado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Upload realizado com sucesso!"
                    },
                    "url": {
                      "type": "string",
                      "example": "https://meuservidor.com/uploads/pasta/arquivo.png"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Nenhum arquivo enviado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Nenhum arquivo enviado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno no servidor"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Retorna a URL pública da foto da capa do livro",
        "description": "Busca a ulr da capa do livro do usuário pelo ID fornecido.",
        "tags": [
          "Interno - files and uploads"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do usuário",
            "example": "clvxyz123abc789"
          }
        ],
        "responses": {
          "200": {
            "description": "URL da imagem retornada com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "url": {
                      "type": "string",
                      "example": "https://supabase.storage.com/bucket/capa/user123.png"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID do usuário não fornecido",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do usuário não fornecido"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "capa não encontrado ou sem imagem cadastrada",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Usuário ou imagem não encontrada"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno no servidor"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/uploads/doc-model": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Cria um novo modelo de documento",
        "description": "Registra um novo model_doc vinculado a um psicólogo, contendo nome, prompt e ferramenta utilizada.",
        "tags": [
          "Interno - files and uploads"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "psicologoId",
                  "prompt",
                  "tool"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "example": "Modelo de Anamnese"
                  },
                  "psicologoId": {
                    "type": "string",
                    "example": "clxyz123abc"
                  },
                  "prompt": {
                    "type": "string",
                    "example": "Gere uma anamnese estruturada com base nas respostas do paciente."
                  },
                  "tool": {
                    "type": "string",
                    "example": "gpt-4o"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Documento criado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "example": {
                    "id": "clzy987asd",
                    "name": "Modelo de Anamnese",
                    "psicologoId": "clxyz123abc",
                    "prompt": "Gere uma anamnese estruturada...",
                    "tool": "gpt-4o",
                    "createdAt": "2025-01-01T12:00:00.000Z",
                    "updatedAt": "2025-01-01T12:00:00.000Z"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Falha de validação (campos obrigatórios ausentes)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Campos obrigatórios: name, psicologoId, prompt"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno no servidor"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Lista todos os modelos de documentos do psicólogo",
        "description": "Retorna os modelos de documentos salvos no banco e também os modelos mockados carregados automaticamente.",
        "tags": [
          "Interno - files and uploads"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "psicologoId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do psicólogo",
            "example": "clxyz123abc"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista completa de modelos (reais + mock)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object"
                  },
                  "example": [
                    {
                      "id": "clzw987asd",
                      "name": "Modelo de Evolução",
                      "psicologoId": "clxyz123abc",
                      "prompt": "Gerar evolução com base nas observações...",
                      "tool": "gpt-4o-mini",
                      "createdAt": "2025-01-01T12:00:00.000Z",
                      "updatedAt": "2025-01-01T12:00:00.000Z"
                    },
                    {
                      "id": "mock-1",
                      "name": "Relatório Inicial",
                      "psicologoId": "clxyz123abc",
                      "prompt": "Gerar relatório inicial...",
                      "tool": "mock"
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Campo obrigatório ausente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Campo obrigatório: psicologoId"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno no servidor"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Remove um modelo de documento",
        "description": "Deleta um registro de modelo de documento pelo ID fornecido.",
        "tags": [
          "Interno - files and uploads"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "docId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do documento a ser deletado",
            "example": "clzw987asd123"
          }
        ],
        "responses": {
          "200": {
            "description": "Documento removido com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Documento deletado com sucesso"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Campo obrigatório não fornecido",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Campo obrigatório: docId"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao deletar o documento",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno no servidor"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/uploads/my-models": {
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Lista modelos de documentos",
        "description": "Retorna todos os documentos cadastrados. Se for informado um psicologoId, retorna apenas os documentos associados a esse profissional.",
        "tags": [
          "Interno - Model Docs"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "psicologoId",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Filtra os documentos pelo ID do psicólogo",
            "example": "clzw987asd123"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de documentos retornada com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string",
                        "example": "clzw987asd123"
                      },
                      "name": {
                        "type": "string",
                        "example": "Relatório clínico"
                      },
                      "prompt": {
                        "type": "string",
                        "example": "Gerar relatório detalhado..."
                      },
                      "tool": {
                        "type": "string",
                        "example": "openai"
                      },
                      "psicologoId": {
                        "type": "string",
                        "example": "abcd1234"
                      },
                      "criado_em": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2025-01-15T18:23:11.000Z"
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro ao buscar documentos",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao buscar documentos"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/uploads/profile": {
      "post": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Faz upload de um arquivo para o storage",
        "description": "Realiza o upload de um arquivo para o bucket correto, dependendo do valor do parâmetro `path`.\n- `profile-pictures` → envia para a pasta de fotos de perfil  \n- `banner` → envia para a pasta de banners  \nO parâmetro `id` é opcional e pode ser usado como nome ou referência do arquivo.\n",
        "tags": [
          "Interno - files and uploads"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "path",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "profile-pictures",
                "banner"
              ]
            },
            "description": "Pasta de destino do arquivo",
            "example": "profile-pictures"
          },
          {
            "in": "query",
            "name": "id",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "ID opcional para identificar o arquivo",
            "example": "clzw123abc987"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "Arquivo a ser enviado"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Upload realizado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Upload realizado com sucesso!"
                    },
                    "url": {
                      "type": "string",
                      "example": "https://supabase.../profile-pictures/abc123.png"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro de validação (arquivo ausente ou parâmetros inválidos)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Nenhum arquivo enviado"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor ao processar o upload",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno no servidor"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Retorna a URL pública da foto de perfil do usuário",
        "description": "Busca a imagem de perfil salva no Supabase Storage e retorna a URL pública.\nCaso o campo `photoprofile` contenha uma URL completa, apenas o path é extraído.\n",
        "tags": [
          "Interno - files and uploads"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do usuário",
            "example": "clzw0t3p8000dxoyxk2h4y1ab"
          }
        ],
        "responses": {
          "200": {
            "description": "URL pública da imagem retornada com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "url": {
                      "type": "string",
                      "example": "https://qfpygaqyldmthqakmisq.supabase.co/storage/v1/object/public/tiviai-images/profile-pictures/abc123.png"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro de requisição (userId ausente)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do usuário não fornecido"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Usuário não encontrado ou sem foto de perfil",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Usuário ou imagem não encontrada"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao gerar a URL pública",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro ao obter URL da imagem"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/internal/user-profile": {
      "get": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Retorna um usuário pelo ID",
        "description": "Busca no banco de dados um usuário específico pelo seu ID.",
        "tags": [
          "Interno - Usuários"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do usuário a ser consultado"
          }
        ],
        "responses": {
          "200": {
            "description": "Usuário encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "example": "abc123"
                    },
                    "name": {
                      "type": "string",
                      "example": "João Silva"
                    },
                    "email": {
                      "type": "string",
                      "example": "joao@email.com"
                    },
                    "role": {
                      "type": "string",
                      "example": "ADMIN"
                    },
                    "vinculo_admin": {
                      "type": "string",
                      "example": "admin123"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2025-11-19T12:00:00.000Z"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2025-11-19T12:00:00.000Z"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID do usuário não fornecido",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do usuário não fornecido."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Usuário não encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Usuário não encontrado."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno do servidor."
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "summary": "Atualiza os dados de um usuário",
        "description": "Atualiza as informações de um usuário existente no sistema pelo ID.",
        "tags": [
          "Interno - Usuários"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string",
                    "description": "ID do usuário a ser atualizado"
                  },
                  "name": {
                    "type": "string",
                    "description": "Nome do usuário"
                  },
                  "email": {
                    "type": "string",
                    "description": "Email do usuário"
                  },
                  "role": {
                    "type": "string",
                    "description": "Papel do usuário. Valores possíveis: ADMIN, PSICOLOGO, PSICOLOGO_ADM, PSYCHOLOGIST, COMMON"
                  },
                  "vinculo_admin": {
                    "type": "string",
                    "description": "ID do usuário administrador vinculado (opcional)"
                  }
                },
                "required": [
                  "id"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Usuário atualizado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "example": {
                    "id": "abc123",
                    "name": "João Silva",
                    "email": "joao@email.com",
                    "role": "ADMIN",
                    "vinculo_admin": null,
                    "createdAt": "2025-11-19T12:00:00.000Z",
                    "updatedAt": "2025-11-19T12:05:00.000Z"
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID do usuário não fornecido",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "ID do usuário é obrigatório."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Usuário não encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Usuário não encontrado."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno do servidor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno do servidor."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/login": {
      "post": {
        "summary": "Realiza login e retorna um JWT",
        "description": "Autentica um usuário pelo email e senha, valida permissões e retorna um token JWT válido por 7 dias.",
        "tags": [
          "Autenticação"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "description": "Email cadastrado do usuário",
                    "example": "usuario@clinica.com"
                  },
                  "password": {
                    "type": "string",
                    "description": "Senha do usuário",
                    "example": "minhasenha123"
                  }
                },
                "required": [
                  "email",
                  "password"
                ]
              },
              "example": {
                "email": "usuario@clinica.com",
                "password": "minhasenha123"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Login realizado com sucesso. Retorna informações do usuário e token JWT.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "user": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "clu12abc90387xyz"
                        },
                        "name": {
                          "type": "string",
                          "example": "João Silva"
                        },
                        "role": {
                          "type": "string",
                          "example": "PSYCHOLOGIST"
                        },
                        "email": {
                          "type": "string",
                          "example": "usuario@clinica.com"
                        },
                        "crp": {
                          "type": "string",
                          "example": "CRP-12/12345"
                        }
                      }
                    },
                    "token": {
                      "type": "string",
                      "description": "JWT válido por 7 dias",
                      "example": "eyJhbGciOiJIUzI1..."
                    },
                    "expiresIn": {
                      "type": "string",
                      "example": "3h"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Email ou senha não enviados.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Email e senha são obrigatórios."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Senha incorreta.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Usuário ou senha incorretos."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Usuário sem permissão para acessar o sistema.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Acesso negado: este usuário não tem permissão."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Usuário não encontrado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Usuário não existe no sistema."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro inesperado ao autenticar o usuário.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno no servidor."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/logout": {
      "get": {
        "summary": "Realiza logout do usuário",
        "description": "Retorna uma confirmação de logout. O cliente deve remover o token JWT manualmente.",
        "tags": [
          "Autenticação"
        ],
        "responses": {
          "200": {
            "description": "Logout realizado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Logout realizado com sucesso"
                    },
                    "aviso": {
                      "type": "string",
                      "example": "Lembre-se de remover o token JWT do armazenamento do cliente (localStorage, cookies, etc.) para completar o logout."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/message": {
      "get": {
        "summary": "Recupera mensagens transcritas de uma sala",
        "description": "Retorna a transcrição completa armazenada temporariamente para a sala informada.",
        "tags": [
          "Transcrição"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "sala",
            "required": true,
            "description": "Identificador único da sala onde as mensagens foram armazenadas.",
            "schema": {
              "type": "string"
            },
            "example": "sala_12345"
          }
        ],
        "responses": {
          "200": {
            "description": "Transcrição retornada com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "transcript": {
                      "type": "string",
                      "example": "Olá, tudo bem?\nPodemos começar a consulta agora."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetro obrigatório ausente.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Parâmetro \"sala\" é obrigatório."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Erro interno do servidor."
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Adiciona um trecho de transcrição a uma sala",
        "description": "Recebe texto transcrito e armazena temporariamente no servidor dentro da sala indicada.",
        "tags": [
          "Transcrição"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "sala",
                  "transcript"
                ],
                "properties": {
                  "sala": {
                    "type": "string",
                    "description": "Identificador único da sala.",
                    "example": "sala_12345"
                  },
                  "transcript": {
                    "type": "string",
                    "description": "Trecho de texto transcrito que será armazenado.",
                    "example": "O paciente relatou melhora desde a última sessão."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Transcrição adicionada com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Transcrição salva com sucesso."
                    },
                    "transcript": {
                      "type": "string",
                      "example": "O paciente relatou melhora desde a última sessão."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Dados inválidos enviados ao servidor.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Dados inválidos. Informe \"sala\" e \"transcript\"."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao processar a requisição.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Erro interno do servidor."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/recupera-senha": {
      "put": {
        "summary": "Recuperação de senha",
        "description": "Envia uma nova senha provisória para o e-mail do usuário, caso o e-mail esteja cadastrado e confirmado.",
        "tags": [
          "Autenticação"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "email"
                ],
                "properties": {
                  "email": {
                    "type": "string",
                    "description": "E-mail cadastrado no sistema.",
                    "example": "usuario@example.com"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Senha alterada com sucesso e enviada por e-mail.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Senha alterada com sucesso. Verifique seu e-mail para a nova senha."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "E-mail não enviado ou e-mail não confirmado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "E-mail não confirmado. Não é possível realizar a recuperação de senha."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "E-mail não encontrado no sistema.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "E-mail não encontrado."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno ao tentar realizar a recuperação de senha.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Erro ao tentar recuperar a senha."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/register_admins": {
      "post": {
        "summary": "Criação de um administrador rota provisoria para criação de usuarios não deve ser exposta em produção",
        "description": "Endpoint para registrar um administrador no sistema.",
        "tags": [
          "Administradores"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "email",
                  "password",
                  "role"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Nome completo do administrador",
                    "example": "João da Silva"
                  },
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "Email do administrador",
                    "example": "joao@email.com"
                  },
                  "password": {
                    "type": "string",
                    "description": "Senha do administrador",
                    "example": 123456
                  },
                  "role": {
                    "type": "string",
                    "description": "Papel do usuário",
                    "enum": [
                      "ADMIN",
                      "SUPER_ADMIN"
                    ],
                    "example": "ADMIN"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Administrador criado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Administrador criado com sucesso"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro de validação nos dados enviados"
          },
          "500": {
            "description": "Erro interno do servidor"
          }
        }
      }
    },
    "/api/save_peer": {
      "get": {
        "summary": "Recupera o peerId associado a um iddinamico",
        "description": "Retorna o peerId salvo no peerStorage a partir de um identificador dinâmico usado nas conexões P2P.",
        "tags": [
          "Peer"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "iddinamico",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID dinâmico usado para mapear um peerId no servidor."
          }
        ],
        "responses": {
          "200": {
            "description": "PeerId encontrado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "peerId": {
                      "type": "string",
                      "description": "Peer ID vinculado ao iddinamico."
                    },
                    "id": {
                      "type": "string",
                      "description": "Mesmo iddinamico fornecido."
                    }
                  }
                },
                "example": {
                  "peerId": "peer-1287312-xas",
                  "id": "abc123"
                }
              }
            }
          },
          "400": {
            "description": "Parâmetro iddinamico não fornecido.",
            "content": {
              "application/json": {
                "example": {
                  "message": "Falta o parâmetro iddinamico."
                }
              }
            }
          },
          "404": {
            "description": "Nenhum peerId encontrado.",
            "content": {
              "application/json": {
                "example": {
                  "message": "Nenhum peerId encontrado para o iddinamico fornecido."
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor.",
            "content": {
              "application/json": {
                "example": {
                  "message": "Erro interno do servidor."
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Registra ou atualiza o peerId associado a um iddinamico",
        "description": "Salva um peerId no armazenamento interno (peerStorage) vinculado ao identificador dinâmico enviado pelo cliente.",
        "tags": [
          "Peer"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "iddinamico",
                  "peerId"
                ],
                "properties": {
                  "iddinamico": {
                    "type": "string",
                    "description": "Identificador dinâmico usado como chave."
                  },
                  "peerId": {
                    "type": "string",
                    "description": "Peer ID a ser associado ao iddinamico."
                  }
                }
              },
              "example": {
                "iddinamico": "abc123",
                "peerId": "peer-091283-asd"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "PeerId salvo com sucesso.",
            "content": {
              "application/json": {
                "example": {
                  "message": "ID salvo com sucesso."
                }
              }
            }
          },
          "400": {
            "description": "Parâmetros ausentes.",
            "content": {
              "application/json": {
                "example": {
                  "message": "Faltam parâmetros obrigatórios."
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor.",
            "content": {
              "application/json": {
                "example": {
                  "message": "Erro interno do servidor."
                }
              }
            }
          }
        }
      }
    },
    "/api/solicitar-acesso": {
      "post": {
        "summary": "Realiza o pré-cadastro de um psicólogo",
        "description": "Cria um registro preliminar de psicólogo no sistema antes da habilitação completa.",
        "tags": [
          "Psicólogos"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "cpf",
                  "cfp",
                  "crp",
                  "nome",
                  "lastname",
                  "rg",
                  "email",
                  "data_nasc",
                  "celular",
                  "telefone"
                ],
                "properties": {
                  "cpf": {
                    "type": "string",
                    "example": "12345678900"
                  },
                  "cfp": {
                    "type": "string",
                    "example": "000000"
                  },
                  "crp": {
                    "type": "string",
                    "example": "08/000000"
                  },
                  "nome": {
                    "type": "string",
                    "example": "João"
                  },
                  "lastname": {
                    "type": "string",
                    "example": "Silva"
                  },
                  "rg": {
                    "type": "string",
                    "example": "12345678-9"
                  },
                  "email": {
                    "type": "string",
                    "example": "joao@email.com"
                  },
                  "data_nasc": {
                    "type": "string",
                    "format": "date",
                    "example": "1990-05-20"
                  },
                  "celular": {
                    "type": "string",
                    "example": "27999999999"
                  },
                  "telefone": {
                    "type": "string",
                    "example": "2733333333"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Pré-cadastro criado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Pré-cadastro realizado com sucesso!"
                    },
                    "data": {
                      "type": "object",
                      "description": "Dados cadastrados do psicólogo."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Algum campo obrigatório não foi enviado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Todos os campos são obrigatórios!"
                    }
                  }
                }
              }
            }
          },
          "409": {
            "description": "CPF ou CRP já cadastrados.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "CPF ou CRP já cadastrado!"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erro interno no servidor.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Erro interno do servidor!"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/swagger": {
      "get": {
        "summary": "Retorna o documento OpenAPI/Swagger da API",
        "description": "Gera o arquivo de especificação OpenAPI em tempo real usando swagger-jsdoc",
        "tags": [
          "Interno - Documentação"
        ],
        "responses": {
          "200": {
            "description": "Documento OpenAPI gerado com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        }
      }
    },
    "/api/validar-anamnese": {
      "get": {
        "summary": "Verifica e autoriza acesso temporário à anamnese",
        "description": "Valida o token de acesso temporário para visualizar a anamnese.  \nA autorização é baseada em:\n- Existência do token no banco\n- Registro do IP\n- Tempo máximo de 30 minutos desde o primeiro acesso\n",
        "tags": [
          "Anamnese"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "psicologoId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID do psicólogo que gerou o acesso."
          },
          {
            "in": "query",
            "name": "token",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Token temporário de acesso à anamnese."
          }
        ],
        "responses": {
          "200": {
            "description": "Acesso autorizado.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "autorizado": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Parâmetros ausentes.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Parâmetros ausentes"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Acesso negado (token expirado ou IP diferente).",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "autorizado": {
                      "type": "boolean",
                      "example": false
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/webhook/pagarme": {
      "post": {
        "summary": "Webhook de eventos do Pagar.me",
        "description": "Endpoint que recebe e processa eventos de pagamento enviados pelo Pagar.me.  \nA autenticação é feita via Basic Auth utilizando credenciais definidas em variáveis de ambiente.\n",
        "tags": [
          "pagarme"
        ],
        "security": [
          {
            "basicAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "description": "Corpo enviado pelo Pagar.me contendo o tipo de evento e dados da ordem.",
                "properties": {
                  "type": {
                    "type": "string",
                    "example": "order.paid"
                  },
                  "data": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string",
                        "example": "ord_12345"
                      },
                      "charges": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "last_transaction": {
                              "type": "object",
                              "properties": {
                                "id": {
                                  "type": "string",
                                  "example": "tran_987654"
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Webhook recebido e processado com sucesso.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "received": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erro ao processar o webhook.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Webhook error"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Autenticação falhou (Basic Auth incorreto).",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "Verifica o status do webhook",
        "description": "Retorna uma mensagem confirmando que o endpoint do webhook está ativo e funcionando corretamente.",
        "tags": [
          "pagarme"
        ],
        "responses": {
          "200": {
            "description": "Webhook respondendo corretamente.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Webhook ativo e funcionando!"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  },
  "security": []
}